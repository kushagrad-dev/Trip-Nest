<h2 class="text-center fw-bold mb-5" style="letter-spacing:.5px;">Admin Dashboard</h2>

<div class="container">

  <!-- STATS ROW -->
  <div class="row mb-5 g-4 text-center">

    <div class="col-md-4">
      <div class="stat-card shadow-sm">
        <h3><%= users.length %></h3>
        <p>Total Users</p>
      </div>
    </div>

    <div class="col-md-4">
      <div class="stat-card shadow-sm">
        <h3><%= listings.length %></h3>
        <p>Total Listings</p>
      </div>
    </div>

    <div class="col-md-4">
      <div class="stat-card shadow-sm">
        <h3><%= reviews.length %></h3>
        <p>Total Reviews</p>
      </div>
    </div>

  </div>


  <!-- USERS -->
  <div class="section-card">
    <div class="section-header">Users Management</div>

    <% users.forEach(u=>{ %>
      <div class="item-row">

        <div>
          <b><%= u.username %></b>
          <div class="sub"> <%= u.email %> </div>
        </div>

        <div class="d-flex gap-2">

          <% if(u.role!=="admin"){ %>
            <form method="POST" action="/admin/user/<%=u._id%>/admin?_method=PATCH">
              <button class="btn btn-sm btn-warning">Make Admin</button>
            </form>
          <% } else { %>
            <span class="badge bg-success align-self-center">Admin</span>
          <% } %>

          <form method="POST" action="/admin/user/<%=u._id%>?_method=DELETE">
            <button class="btn btn-sm btn-danger">Delete</button>
          </form>

        </div>
      </div>
    <% }) %>

  </div>


  <!-- LISTINGS -->
  <div class="section-card">
    <div class="section-header">Listings Control</div>

    <% listings.forEach(l=>{ %>
      <div class="item-row">

        <div>
          <b><%= l.title %></b>
          <div class="sub">Owner: <%= l.owner.username %></div>
        </div>

        <form method="POST" action="/admin/listing/<%=l._id%>?_method=DELETE">
          <button class="btn btn-sm btn-danger">Remove</button>
        </form>

      </div>
    <% }) %>

  </div>


  <!-- REVIEWS -->
  <div class="section-card">
    <div class="section-header">Reviews Moderation</div>

    <% reviews.forEach(r=>{ %>
      <div class="item-row">

        <div>
          <%= r.comment %>
          <div class="sub">by <%= r.author.username %></div>
        </div>

        <form method="POST" action="/admin/review/<%=r._id%>?_method=DELETE">
          <button class="btn btn-sm btn-danger">Delete</button>
        </form>

      </div>
    <% }) %>

  </div>

</div>


<style>

.section-card{
  background:#fff;
  border-radius:18px;
  padding:1.5rem;
  margin-bottom:3rem;
  box-shadow:0 10px 30px rgba(0,0,0,.08);
}

.section-header{
  font-weight:700;
  font-size:1.15rem;
  margin-bottom:1.2rem;
  border-left:4px solid #fe424d;
  padding-left:.6rem;
}

.item-row{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:.75rem 0;
  border-bottom:1px solid #f1f1f1;
}

.item-row:last-child{
  border-bottom:none;
}

.sub{
  font-size:.8rem;
  color:#777;
}

.stat-card{
  background:#fff;
  padding:1.8rem 1rem;
  border-radius:18px;
  transition:.25s ease;
}

.stat-card:hover{
  transform:translateY(-6px);
  box-shadow:0 15px 35px rgba(0,0,0,.12)!important;
}

.stat-card h3{
  font-weight:700;
  margin-bottom:.3rem;
}

.stat-card p{
  color:#777;
  margin:0;
}

</style>